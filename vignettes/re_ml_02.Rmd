---
title: "Report_6"
author: "Dario Maccioni"
date: "`r Sys.Date()`"
output: 
  html_document: 
    toc: yes
    toc_float: yes
    numbered: yes
    theme: journal
---

# AGDS Report Exercise 6

```{r message=FALSE, warning=FALSE}
source("../Functions/ml_02_func.R")
```

## Task 1 - Data visualization and checking missing values

__Davos Dataset__ 

```{r}
visdat::vis_miss(eco_flux_davos, warn_large_data = FALSE) # Checking if any data in the dataset is missing for Davos Dataset
```

```{r message = FALSE, warning=FALSE}
# plotting the data to see if there is bad data
library(ggplot2)
eco_flux_davos |> 
  ggplot(aes(x = GPP_NT_VUT_REF, y = ..count..)) + 
  geom_histogram()
```

__Laegern Dataset__ 

```{r}
visdat::vis_miss(eco_flux_laegern, warn_large_data = FALSE) # Checking if any data in the dataset is missing for the Laegern Dataset
```

```{r message = FALSE, warning=FALSE}
# plotting the data to see if there is bad data
library(ggplot2)
eco_flux_laegern |> 
  ggplot(aes(x = GPP_NT_VUT_REF, y = ..count..)) + 
  geom_histogram()
```

## Task 2 - Within-site predictions

### Task 2.1 - KNN/lm Davos (within-site)

```{r message=FALSE, warning=FALSE}
eval_model_2(mod_1 = caret_knn_davos_train, df_train = flux_davos_train, df_test = flux_davos_test, mod_2 = caret_lm_davos_train, df_train2 = flux_davos_train, df_test2 = flux_davos_test)
```

### Task 2.2 - KNN/lm Laegern (within-site)

```{r message=FALSE, warning=FALSE}
eval_model_2(mod_1 = caret_knn_laegern_train, df_train = flux_laegern_train, df_test = flux_laegern_test, mod_2 = caret_lm_laegern_train, df_train2 = flux_laegern_train, df_test2 = flux_laegern_test)
```

## Task 3 - across-site predictions

### Task 3.1 - KNN/lm Davos (across-site)

```{r message=FALSE, warning=FALSE}
eval_model_2(mod_1 = caret_knn_davos_train, df_train = flux_davos_train, df_test = flux_laegern_test, mod_2 = caret_lm_davos_train, df_train2 = flux_davos_train, df_test2 = flux_laegern_test)
```

### Task 3.2 - KNN/lm Laegern (across-site)

```{r message=FALSE, warning=FALSE}
eval_model_2(mod_1 = caret_knn_laegern_train, df_train = flux_laegern_train, df_test = flux_davos_test, mod_2 = caret_lm_laegern_train, df_train2 = flux_laegern_train, df_test2 = flux_davos_test)
```



## Task 4 - lm Laegern/Davos (within-site)

```{r message=FALSE, warning=FALSE}
source("../Functions/ml_01_func.R")
```

```{r message=FALSE, warning=FALSE}
eval_model(mod = caret_lm_pool_train, df_train = pool_dav_lae_train, df_test = pool_dav_lae_test)
```

